# -*- coding: utf-8 -*-
"""
Created on Tue Feb 28 11:47:23 2023

@author: xieyushan
"""


import QuantLib as ql



def calendar_china_ib_mod():
    calendar = ql.China(ql.China.IB)
    add_holiday_list = ['2022-01-01', '2022-01-02', '2022-01-03', 
                        '2022-01-31', '2022-02-01', '2022-02-02', '2022-02-03', '2022-02-04', '2022-02-05', '2022-02-06', 
                        '2022-04-03', '2022-04-04', '2022-04-05', 
                        '2022-04-30',' 2022-05-01', '2022-05-02', '2022-05-03', '2022-05-04',
                        '2022-06-03', '2022-06-04', '2022-06-05',
                        '2022-09-10', '2022-09-11', '2022-09-12',
                        '2022-10-01', '2022-10-02', '2022-10-03', '2022-10-04', '2022-10-05', '2022-10-06', '2022-10-07',
                        '2022-12-31', '2023-01-01', '2023-01-02',
                        '2023-01-21', '2023-01-22', '2023-01-23', '2023-01-24', '2023-01-25', '2023-01-26', '2023-01-27',
                        '2023-04-05',
                        '2023-04-29', '2023-04-30', '2023-05-01', '2023-05-02', '2023-05-03',
                        '2023-06-22', '2023-06-23', '2023-06-24',
                        '2023-09-29', '2023-09-30', '2023-10-01', '2023-10-02', '2023-10-03', '2023-10-04', '2023-10-05', '2023-10-06']
    
    remove_holiday_list = ['2022-01-29', '2022-01-30', '2022-04-02', '2022-04-24', '2022-05-07', '2022-10-08', '2022-10-09',
                           '2023-01-28', '2023-01-29', '2023-04-23', '2032-05-06', '2023-06-25', '2023-10-07', '2023-10-08']

    for d in add_holiday_list:
        d = ql.DateParser.parseFormatted(d, '%Y-%m-%d')   
        calendar.addHoliday(d)
    
    for d in remove_holiday_list:
        d = ql.DateParser.parseFormatted(d, '%Y-%m-%d')
        calendar.removeHoliday(d)
   
    return calendar  